--- apt-0.5.4cnc1.orig/configure.in	Tue Jul  9 12:28:05 2002
+++ apt-0.5.4cnc1/configure.in	Fri Jul 19 00:11:07 2002
@@ -64,6 +64,7 @@
 dnl   AC_MSG_ERROR(failed: I need posix threads, pthread)
 dnl fi
 
+dnl ALT:We need this to build apt-ftparchive
 dnl Check for DB2
 AC_CHECK_HEADER(db2/db.h,
      [AC_CHECK_LIB(db2,db_open,
@@ -77,7 +78,6 @@
 SAVE_CPPFLAGS="$CPPFLAGS"
 
 CPPFLAGS="$SAVE_CPPFLAGS -I/usr/include/rpm"
-AC_CHECK_HEADERS(db1/db.h)
 AC_CHECK_HEADER(rpm/rpmlib.h, rpm_header_ok=1, rpm_header_ok=0)
 
 if test $rpm_header_ok = 1; then
@@ -85,7 +85,7 @@
       LIBS="$SAVE_LIBS -lrpm -lrpmio -lz -lbz2 -lpopt"
       AC_CHECK_LIB(rpmdb,rpmdbOpen,
         [RPMDBLIBS="-lrpmdb"],
-        [RPMDBLIBS="-ldb-3.1"])
+        [RPMDBLIBS="-ldb"])
 
       LIBS="$SAVE_LIBS $RPMDBLIBS -lrpmio -lz -lbz2 -lpopt"
       AC_CHECK_LIB(rpm,rpmdbGetIteratorOffset,
@@ -100,6 +100,7 @@
               [AC_DEFINE_UNQUOTED(HAVE_RPM, 1) 
 	       RPMLIBS="-lrpm -ldb1 -lz -lbz2 -lpopt"
                SAVE_CPPFLAGS="$SAVE_CPPFLAGS -I/usr/include/rpm"
+	       AC_CHECK_HEADERS(db1/db.h)
 	       rpm_version="3"])
       fi
       if test $rpm_version != "none"; then
--- apt-0.5.4cnc1.orig/tools/cached_md5.cc	Tue Jul  9 02:41:48 2002
+++ apt-0.5.4cnc1/tools/cached_md5.cc	Thu Jul 18 22:47:39 2002
@@ -39,6 +39,7 @@
 #include <errno.h>
 #include <fcntl.h>
 #include <rpm/rpmlib.h>
+#include <rpm/misc.h>
 #include <stdlib.h>
 #include <string.h>
 #include <sys/stat.h>
--- apt-0.5.4cnc1.orig/tools/hdlist2pkglist.cc	Tue Jul  9 02:42:13 2002
+++ apt-0.5.4cnc1/tools/hdlist2pkglist.cc	Thu Jul 18 22:48:22 2002
@@ -37,6 +37,7 @@
 #include <errno.h>
 #include <fcntl.h>
 #include <rpmlib.h>
+#include <rpm/misc.h>
 #include <stdlib.h>
 #include <string.h>
 #include <sys/stat.h>
